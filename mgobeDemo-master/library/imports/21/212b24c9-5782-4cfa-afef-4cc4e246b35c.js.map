{"version":3,"sources":["assets\\Script\\index.js"],"names":["MGOBE","require","gameId","secretKey","serverUrl","CC_EDITOR","Editor","CocosService_mgobeDemo","log","lang","gameInfo","openId","Math","random","config","url","reconnectMaxTimes","reconnectInterval","resendInterval","resendTimeout","cacertNativeUrl","playerInfo","name","matchRoomPara","maxPlayers","roomType","cc","Class","Component","properties","btnInit","type","Button","btnJoin","labelJoin","Label","btnSendMessage","btnFrameSync","btnSendToServer","labelFrameSync","logListView","ScrollView","itemTemplate","Node","cacertFile","Asset","joined","synced","room","logs","onLoad","interactable","sys","language","string","tempText","tempSize","tempTop","debug","setDisplayStats","onDestroy","initMultiLang","LANGUAGE_CHINESE","LANGUAGE_ENGLISH","init","_self","DebuggerLog","enable","isNative","loader","md5Pipe","transformURL","nativeUrl","Listener","event","console","code","printLog","Room","add","onJoinRoom","bind","onLeaveRoom","onRecvFromClient","onRecvFrame","onStartFrameSync","onStopFrameSync","onRecvFromGameSvr","joinRoom","leaveRoom","roomInfo","id","initRoom","matchRoom","sendMessage","sendToClientPara","recvType","ENUM","RecvType","ROOM_ALL","recvPlayerList","msg","sendToClient","frameSync","stopFrameSync","startFrameSync","sendToServer","sendToGameServerPara","data","cmd","sendToGameSvr","sendFrame","err","joinPlayerId","leavePlayerId","frame","items","length","printCode","info","content","removeAllChildren","update","dt","item","instantiate","addChild","getComponent","updateItem","lab","_forceUpdateRenderData","layout","Layout","updateLayout","scrollToBottom"],"mappings":"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","sourceRoot":"/","sourcesContent":["\n// 导入 MGOBE.js\nconst MGOBE = require(\"MGOBE\");\n// 获取 Room、Listener 对象\n// const { Room, Listener } = MGOBE;\n\nconst gameId = \"obg-bq3n2v8a\"; //替换为控制台上的 游戏 ID\nconst secretKey = \"9d08a4a8f7edd8c6025e6ca63a6e9b0cd9878aeb\"; //替换为控制台上的 游戏 Key\nconst serverUrl = \"bq3n2v8a.wxlagame.com\"; //替换为控制台上的 域名\nif (CC_EDITOR) {\n  if (!Editor.CocosService_mgobeDemo) {\n    Editor.CocosService_mgobeDemo = true;\n    Editor.log(\n      Editor.lang === \"zh\"\n        ? \"欢迎使用腾讯云 MGOBE 小游戏联机对战引擎服务！\"\n        : \"Welcome to Tencent Cloud MGOBE online game engine service!\"\n    );\n    Editor.log(\n      Editor.lang === \"zh\"\n        ? \"这是一个简单的 MGOBE 示例 Demo，通过本示例您可以快速了解如何使用 MGOBE 来实现小游戏联机对战！\"\n        : \"This is a simple MGOBE sample demo. Through this example, you can quickly learn how to use MGOBE to achieve online mini-games!\"\n    );\n  }\n  if (gameId === \"\" || secretKey === \"\" || serverUrl === \"\") {\n    Editor.log(\n      Editor.lang === \"zh\"\n        ? \"您需要首先从右侧的服务面板开启 腾讯云MGOBE 服务，然后从 腾讯云MGOBE 服务面板前往腾讯云控制台获取 SDK 初始化参数并填写到示例代码中的相关位置，以使 Demo 能够运行。\"\n        : \"You need to start the Tencent Cloud MGOBE service from the service panel on the right, then go to the Tencent Cloud console from the Tencent Cloud MGOBE service panel to get the SDK initialization parameters and fill in the relevant locations in the sample code to enable the Demo to run.\"\n    );\n    Editor.log(\n      Editor.lang === \"zh\"\n        ? \"初始化参数所在位置：assets/Script/index.js 文件最顶部\"\n        : \"Location of initialization parameters: the top of the assets/Script/index.js file\"\n    );\n  }\n  \n}\n\nconst gameInfo = {\n  gameId: gameId,\n  openId: \"openid_test\" + Math.random(), //自定义的用户唯一ID\n  secretKey: secretKey\n};\nconst config = {\n  url: serverUrl,\n  reconnectMaxTimes: 5,\n  reconnectInterval: 1000,\n  resendInterval: 1000,\n  resendTimeout: 10000,\n  cacertNativeUrl: \"\"\n};\n\nconst playerInfo = {\n  name: \"Tom\" + Math.random()\n};\n\nconst matchRoomPara = {\n  playerInfo,\n  maxPlayers: 5,\n  roomType: \"1\"\n};\n\ncc.Class({\n  extends: cc.Component,\n\n  properties: {\n    btnInit: {\n      default: null,\n      type: cc.Button\n    },\n    btnJoin: {\n      default: null,\n      type: cc.Button\n    },\n    labelJoin: {\n      default: null,\n      type: cc.Label\n    },\n    btnSendMessage: {\n      default: null,\n      type: cc.Button\n    },\n    btnFrameSync: {\n      default: null,\n      type: cc.Button\n    },\n    btnSendToServer: {\n      default: null,\n      type: cc.Button\n    },\n    labelFrameSync: {\n      default: null,\n      type: cc.Label\n    },\n    logListView: {\n      default: null,\n      type: cc.ScrollView\n    },\n    itemTemplate: {\n      default: null,\n      type: cc.Node\n    },\n    cacertFile: {\n      default: null,\n      type: cc.Asset\n    },\n    joined: false,\n    synced: false,\n    lang: \"zh\",\n    room: null,\n    logs: []\n  },\n\n  onLoad: function () {\n    this.btnInit.interactable = true;\n    this.btnJoin.interactable = false;\n    this.btnSendMessage.interactable = false;\n    this.btnFrameSync.interactable = false;\n    this.btnSendToServer.interactable = false;\n    this.lang = cc.sys.language;\n    this.labelJoin.string = \"加入房间\";\n    this.labelFrameSync.string = \"开始帧同步\";\n    this.tempText = \"\";\n    this.tempSize = 0;\n    this.tempTop = 0;\n    cc.debug.setDisplayStats(false);\n  },\n\n  onDestroy: function () { },\n\n  initMultiLang: function () {\n    if (this.lang === cc.sys.LANGUAGE_CHINESE) {\n    } else if (this.lang === cc.sys.LANGUAGE_ENGLISH) {\n    }\n  },\n\n  init: function () {\n    const _self = this;\n    // cc.log(MGOBE);\n    MGOBE.DebuggerLog.enable = true;\n    // 如果是原生平台，则加载 Cert 证书，否则会提示 WSS 错误\n    if (cc.sys.isNative)\n      config.cacertNativeUrl = cc.loader.md5Pipe\n        ? cc.loader.md5Pipe.transformURL(this.cacertFile.nativeUrl)\n        : this.cacertFile.nativeUrl;\n    MGOBE.Listener.init(gameInfo, config, event => {\n      console.log(event);\n      if (event.code === 0) {\n        _self.printLog(\"初始化成功\");\n        _self.room = new MGOBE.Room();\n        MGOBE.Listener.add(_self.room);\n        _self.room.onJoinRoom = _self.onJoinRoom.bind(_self);\n        _self.room.onLeaveRoom = _self.onLeaveRoom.bind(_self);\n        _self.room.onRecvFromClient = _self.onRecvFromClient.bind(_self);\n        _self.room.onRecvFrame = _self.onRecvFrame.bind(_self);\n        _self.room.onStartFrameSync = _self.onStartFrameSync.bind(_self);\n        _self.room.onStopFrameSync = _self.onStopFrameSync.bind(_self);\n        _self.room.onRecvFromGameSvr = _self.onRecvFromGameSvr.bind(_self);\n        _self.btnJoin.interactable = true;\n      } else {\n        _self.printLog(\"初始化失败\");\n      }\n    });\n  },\n\n  joinRoom: function () {\n    const _self = this;\n    if (this.joined) {\n      this.room.leaveRoom({}, event => {\n        console.log(event);\n        if (event.code === 0) {\n          _self.printLog(\"退房成功\", _self.room.roomInfo.id);\n          _self.room.initRoom();\n          _self.labelJoin.string = \"加入房间\";\n          _self.btnSendMessage.interactable = false;\n          _self.btnFrameSync.interactable = false;\n          _self.btnSendToServer.interactable = false;\n          _self.joined = false;\n        }\n      });\n    } else {\n      this.room.matchRoom(matchRoomPara, event => {\n        console.log(event);\n        if (event.code === 0) {\n          _self.printLog(\"匹配成功\");\n          _self.labelJoin.string = \"离开房间\";\n          _self.btnSendMessage.interactable = true;\n          _self.btnFrameSync.interactable = true;\n          _self.btnSendToServer.interactable = true;\n          _self.joined = true;\n        } else {\n          _self.printLog(\"匹配失败\");\n        }\n      });\n    }\n  },\n\n  sendMessage: function () {\n    const sendToClientPara = {\n      recvType: MGOBE.ENUM.RecvType.ROOM_ALL,\n      recvPlayerList: [],\n      msg: \"hello\" + Math.random()\n    };\n    this.room.sendToClient(sendToClientPara, event => console.log(event));\n  },\n\n  frameSync: function () {\n    const _self = this;\n    if (this.synced) {\n      this.room.stopFrameSync({}, event => {\n        console.log(event);\n        if (event.code === 0) {\n          _self.printLog(\"停止帧同步成功\");\n          _self.labelFrameSync.string = \"开始帧同步\";\n          _self.synced = false;\n        }\n      });\n    } else {\n      this.room.startFrameSync({}, event => {\n        console.log(event);\n        if (event.code === 0) {\n          _self.printLog(\"开始帧同步成功，请到控制台查看具体帧同步信息\");\n          _self.labelFrameSync.string = \"停止帧同步\";\n          _self.synced = true;\n        }\n      });\n    }\n  },\n\n  sendToServer: function () {\n    const sendToGameServerPara = {\n      data: {\n        cmd: 1\n      }\n    };\n    this.room.sendToGameSvr(sendToGameServerPara, event => console.log(event));\n  },\n\n  sendFrame: function () {\n    this.room.sendFrame(\n      {\n        data: {\n          cmd: \"xxxxxxxx\" + Math.random(),\n          data: \"asdgjasdhgkasdf\",\n          id: \"xxxxxxxx\" + Math.random()\n        }\n      },\n      err => {\n        //console.log(\"err\", err);\n      }\n    );\n  },\n\n  onJoinRoom: function (event) {\n    this.printLog(\"新玩家加入\" + event.data.joinPlayerId);\n    console.log(\"新玩家加入\", event.data.joinPlayerId);\n  },\n\n  onLeaveRoom: function (event) {\n    this.printLog(\"玩家退出\" + event.data.leavePlayerId);\n    console.log(\"玩家退出\", event.data.leavePlayerId);\n  },\n\n  onRecvFromClient: function (event) {\n    this.printLog(\"新消息\" + event.data.msg);\n    console.log(\"新消息\", event.data.msg);\n  },\n\n  onRecvFrame: function (event) {\n    this.sendFrame();\n    console.log(\"帧广播\", event.data.frame);\n    if (event.data.frame.items && event.data.frame.items.length > 0) {\n      //this.printLog(\"帧广播\" + JSON.stringify(event.data.frame.items));\n      console.log(\"帧广播\", event.data.frame);\n    }\n  },\n\n  onStartFrameSync: function (event) {\n    this.synced = true;\n    this.labelFrameSync.string = \"停止帧同步\";\n    //this.printLog(\"开始帧同步\\n\");\n  },\n\n  onStopFrameSync: function (event) {\n    this.synced = false;\n    this.labelFrameSync.string = \"开始帧同步\";\n    //this.printLog(\"停止帧同步\\n\");\n  },\n\n  onRecvFromGameSvr: function (event) {\n    console.log(\"新自定义服务消息\", event);\n    //this.printLog(\"新自定义服务消息\" + JSON.stringify(event));\n  },\n\n  printCode: function (code) {\n    this.printLog(\"   \");\n    this.printLog(\"---------- Sample code start ----------\");\n    this.printLog(code);\n    this.printLog(\"---------- Sample code end   ----------\");\n    this.printLog(\"   \");\n  },\n\n  printLog: function (info) {\n    if (this.tempSize > 100) {\n      this.tempSize = 0;\n      this.logListView.content.removeAllChildren(true);\n    }\n    this.tempSize = 0;\n    this.tempText = this.tempText + info;\n  },\n\n  // called every frame\n  update: function (dt) {\n    if (this.tempText.length <= 0) return;\n\n    var item = cc.instantiate(this.itemTemplate);\n\n    this.logListView.content.addChild(item);\n    item.getComponent(\"Item\").updateItem(this.tempText);\n\n    var lab = item.getComponent(cc.Label);\n    lab._forceUpdateRenderData(true);\n\n    var layout = this.logListView.content.getComponent(cc.Layout);\n    layout.updateLayout();\n\n    this.logListView.scrollToBottom(1 / 60);\n    this.tempText = \"\";\n  }\n});\n"]}